{# relatórioHumor.html #}
{% extends 'app_LyfeSync/layouts/masterpage_logado.html' %}
{% load static %}
{% load custom_filters %}
{% load app_LyfeSync_extras %}

{% block title %}
  Relatório de Humor
{% endblock %}

{% block content %}
  <div class="container mx-auto p-4 md:p-8">
    <div class="flex items-center justify-between mb-8 border-b-2 border-indigo-500 pb-2">
      <h1 class="text-3xl font-extrabold text-gray-800">Seu Histórico de Humor</h1>
      <a href="{% url 'relatorios' %}" class="text-sm font-medium text-indigo-600 hover:text-indigo-800 transition duration-150 ease-in-out">&larr; Voltar para Relatórios</a>
    </div>

    <p class="text-lg mb-6 text-gray-600">Esta tabela exibe todos os seus registros de humor, ordenados do mais recente para o mais antigo, com o nome do estado emocional e sua descrição.</p>

    <!-- Estrutura da Tabela (Responsiva) -->
    <div class="bg-white shadow-xl rounded-xl overflow-hidden">
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-indigo-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-bold text-indigo-600 uppercase tracking-wider">Data</th>
              <th class="px-6 py-3 text-left text-xs font-bold text-indigo-600 uppercase tracking-wider">Estado de Humor</th>
              <th class="px-6 py-3 text-left text-xs font-bold text-indigo-600 uppercase tracking-wider">Descrição/Nota</th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            {% if humores_registrados %}
              {% for humor in humores_registrados %}
                <tr class="hover:bg-gray-50 transition duration-100 ease-in-out">
                  <!-- Coluna Data -->
                  <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{{ humor.data }}</td>

                  <!-- Coluna Estado de Humor (Com Icon/Nome) -->
                  <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                    <div class="flex items-center space-x-3">
                      <!-- Ícone do Humor (imagem estática) -->
                      <img src="{% static humor.image_path %}" alt="{{ humor.estado }}" class="w-8 h-8 rounded-full border-2 border-gray-100 object-cover" onerror="this.onerror=null;this.src='{% static 'img/icon/default.png' %}'" />
                      <!-- O NOME do Humor -->
                      <span class="font-semibold text-base text-gray-800">{{ humor.estado }}</span>
                    </div>
                  </td>

                  <!-- Coluna Descrição -->
                  <td class="px-6 py-4 text-sm text-gray-600 max-w-xs xl:max-w-md">{{ humor.descricaohumor|default:'Nenhuma nota adicionada.' }}</td>
                </tr>
              {% endfor %}
            {% else %}
              <tr>
                <td colspan="3" class="px-6 py-10 text-center text-gray-500 italic bg-gray-50">
                  Você ainda não registrou nenhum humor. Comece a registrar para ver seu histórico aqui!<div class="mt-4">
                    <a href="{% url 'registrar_humor' %}" class="text-indigo-600 font-medium hover:underline">Registrar Meu Humor Agora</a>
                  </div>
                </td>
              </tr>
            {% endif %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
{% endblock %}
